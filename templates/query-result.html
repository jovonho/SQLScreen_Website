<!DOCTYPE html>
<html lang="en">

<head>
    <title>TMX Screen</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A simple stock screener for the TSX.">
    <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;1,300&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/static/vendors/css/bootstrap-3.3.7.min.css">
    <link rel="stylesheet" type="text/css" href="/static/vendors/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="/static/vendors/css/grid.css">
    <link rel="stylesheet" type="text/css" href="/static/resources/css/results_style.css">
    <link rel="stylesheet" type="text/css" href="/static/resources/css/queries.css">
</head>

<body>
    <header>
        <nav>
            <div class="row">
                <div class="main-nav">
                    <ul class="main-nav-items">
                        <li><a href="#about">About</a></li>
                        <li><a href="#steps">How it works</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <section class="query-section">
        <!-- <div class="row">
            <h1>Query was: {{ query }}</h1>
        </div> -->
        <div class="row">
            <h3>Data as of 2020-12-25</h3>
            <h3>All prices in CAD</h3>
        </div>
    </section>

    <section class="main-section">
        {% for result in query_result %}
        <div class="row">
            <div class="result-container">
                <div class="result-line line-price-name">
                    <div class="price-n-change">
                        <div class="price">${{ result['price'] }} </div>
                        <div
                            class="change {{'ch-pos' if result['percentchange'] > 0 else 'ch-neg' if result['percentchange'] < 0 }}">
                            <div class="ch-price">{{ format_change(result['pricechange']) }}</div>
                            <div class="ch-percent">({{ format_change(result['percentchange']) }}&nbsp;%)</div>
                        </div>
                    </div>
                    <div class="name-indus-col">
                        <div class="result-id-info">
                            <a href="https://money.tmx.com/en/quote/{{ result['symbol'] }}"><span
                                    class="empty-span"></span></a>
                            <h2 class="symbol">{{ result['symbol'] }}</h2>
                            <div class="sep">&mdash;</div>
                            <h3 class="name">{{ result['name'] }}</h3>
                        </div>
                    </div>
                </div>
                <div class="result-line line-ex-sector">
                    <div class="result-class-info">
                        <div class="exchange"> {{ result['exshortname'] }}</div>
                        <div class="sep">&mdash;</div>
                        <div class="class-info-sector sector-info">
                            <div class="class-info-label label-sector">Sector:</div>
                            <div class="class-info-value sector">{{ not_none(result['sector']) }}</div>
                        </div>
                        <div class="class-info-sector industry-info">
                            <div class="class-info-label label-industry">Industry:</div>
                            <div class="class-info-value industry">{{ not_none(result['industry']) }}</div>
                        </div>
                    </div>
                </div>

                <div class="result-line line-info">
                    <div class="result-block price-info-block">
                        <div class="block-subline block-title">
                            <div class="label">Price</div>
                        </div>
                        <div class="block-subline">
                            <div class="result-block-col">
                                <div class="info-block">
                                    <div class="label">Close</div>
                                    <div class="value">{{ format_price(result['price']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Open</div>
                                    <div class="value">{{ format_price(result['openprice']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Prv. Close</div>
                                    <div class="value">{{ format_price(result['prevclose']) }}</div>
                                </div>
                            </div>

                            <div class="result-block-col">
                                <div class="info-block">
                                    <div class="label">Day Range</div>
                                    <div class="value">{{ format_price(result['daylow']) }}/{{
                                        format_price(result['dayhigh']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Year Range</div>
                                    <div class="value">{{ format_price(result['weeks52low']) }}/{{
                                        format_price(result['weeks52high']) }}
                                    </div>
                                </div>
                                <div class="info-block">
                                    <div class="label">VWAP</div>
                                    <div class="value">{{ format_financial(result['vwap']) }}</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="result-block price-avg-block">
                        <div class="block-subline block-title">
                            <div class="label">Avg Price</div>
                        </div>
                        <div class="result-block-col">
                            <div class="info-block">
                                <div class="label">21d</div>
                                <div class="value">{{ format_2_decimals(result['day21movingavg']) }}</div>
                            </div>
                            <div class="info-block">
                                <div class="label">50d</div>
                                <div class="value">{{ format_2_decimals(result['day50movingavg']) }}</div>
                            </div>
                            <div class="info-block">
                                <div class="label">200d</div>
                                <div class="value">{{ format_2_decimals(result['day200movingavg']) }}</div>
                            </div>
                        </div>
                    </div>

                    <div class="result-block shares-info-block">
                        <div class="block-subline block-title">
                            <div class="label">Shares</div>
                        </div>
                        <div class="block-subline">
                            <div class="result-block-col">
                                <div class="info-block">
                                    <div class="label">Volume</div>
                                    <div class="value">{{ format_comma(result['volume']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Outstanding</div>
                                    <div class="value">{{ format_comma(result['shareoutstanding']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Market Cap</div>
                                    <div class="value">{{ format_comma(result['marketcap']) }}</div>
                                </div>
                            </div>

                            <div class="result-block-col">
                                <div class="info-block">
                                    <div class="label">Escrowed</div>
                                    <div class="value">{{ format_comma(result['sharesescrow']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Total Outstanding</div>
                                    <div class="value">{{ format_comma(result['totalsharesoutstanding']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Market Cap (all classes)</div>
                                    <div class="value">{{ format_comma(result['marketcapallclasses']) }}</div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="result-block vol-avg-block">
                        <div class="block-subline block-title">
                            <div class="label">Avg Volume</div>
                        </div>
                        <div class="result-block-col">
                            <div class="info-block">
                                <div class="label">10d</div>
                                <div class="value">{{ format_comma(result['averagevolume10d']) }}</div>
                            </div>
                            <div class="info-block">
                                <div class="label">30d</div>
                                <div class="value">{{ format_comma(result['averagevolume30d']) }}</div>
                            </div>
                            <div class="info-block">
                                <div class="label">50d</div>
                                <div class="value">{{ format_comma(result['averagevolume50d']) }}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="result-line line-info">
                    <div class="result-block financial-block">
                        <div class="block-subline block-title">
                            <div class="label">Financials</div>
                        </div>
                        <div class="block-subline">
                            <div class="result-block-col">
                                <div class="info-block">
                                    <div class="label">Alpha</div>
                                    <div class="value">{{ format_financial(result['alpha']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Beta</div>
                                    <div class="value">{{ format_financial(result['beta']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">EPS</div>
                                    <div class="value">{{ format_financial(result['eps']) }}</div>
                                </div>

                            </div>
                            <div class="result-block-col">
                                <div class="info-block">
                                    <div class="label">Price / Earnings</div>
                                    <div class="value">{{ format_financial(result['peratio']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Price / Book</div>
                                    <div class="value">{{ format_financial(result['pricetobook']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Price / Cashflow</div>
                                    <div class="value">{{ format_financial(result['pricetocashflow']) }}</div>
                                </div>
                            </div>
                            <div class="result-block-col">
                                <div class="info-block">
                                    <div class="label">Return on Equity</div>
                                    <div class="value">{{ format_financial(result['returnonequity']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Return on Assets</div>
                                    <div class="value">{{ format_financial(result['returnonassets']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Debt / Equity</div>
                                    <div class="value">{{ format_financial(result['totaldebttoequity']) }}</div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="result-block dividend-block">
                        <div class="block-subline block-title">
                            <div class="label">Dividend</div>
                        </div>
                        <div class="block-subline">
                            {% if result['dividendfrequency'] is not none %}
                            <div class="result-block-col">
                                <div class="info-block">
                                    <div class="label">Frequency</div>
                                    <div class="value">{{ result['dividendfrequency'] }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Amount</div>
                                    <div class="value">
                                        <div class="value-amt">
                                            {{ format_financial(result['dividendamount']) }}
                                        </div>
                                        <div class="value-curr">{{result['dividendcurrency']}}</div>
                                    </div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Yield </div>
                                    <div class="value">{{ result['dividendyield'] }}%</div>
                                </div>
                            </div>
                            <div class="result-block-col">
                                <div class="info-block">
                                    <div class="label">Ex date </div>
                                    <div class="value">{{ format_divi_date(result['exdividenddate']) }}</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">Paydate </div>
                                    <div class="value">{{ format_divi_date(result['dividendpaydate'])}}</div>
                                </div>
                            </div>
                            {% else %}
                            <div class="result-block-col">
                                <div class="info-block">
                                    <div class="label">&nbsp;</div>
                                    <div class="value">-</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">&nbsp;</div>
                                    <div class="value">&nbsp;</div>
                                </div>
                                <div class="info-block">
                                    <div class="label">&nbsp;</div>
                                    <div class="value">&nbsp;</div>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>



                </div>
            </div>
        </div>
        {% endfor %}
    </section>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="/static/resources/js/scripts_results.js"></script>
</body>

</html>